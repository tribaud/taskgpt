<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <title>Task Manager + IA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <h1>√âditeur de t√¢ches (tasks.json) + Chat IA</h1>
    </header>
    <div class="wrap">

        <div class="toolbar">
            <div class="group">
                <button class="primary" id="btnNew">üÜï Nouveau</button>
                <button id="btnOpen">üìÇ Ouvrir</button>
                <button id="btnSave">üíæ Sauvegarder JSON</button>
                <button id="btnExportMD">üìÑ Exporter Markdown</button>
                <button id="btnCopyPrompt">üìã Copier prompt initial</button>
            </div>
            <div class="group">
                <label class="muted">Mod√®le JSON normalis√©</label>
                <select id="schemaSelect">
                    <option value="v1" selected>v1 (id,title,description,priority,done,dependencies,tags)</option>
                </select>
            </div>
        </div>

        <div class="grid">
            <!-- TABLEAU T√ÇCHES -->
            <section class="card">
                <h2>T√¢ches</h2>
                <div class="row-actions" style="margin-bottom:8px;">
                    <button id="btnAdd">‚ûï Ajouter une t√¢che</button>
                    <button id="btnSort">‚ÜïÔ∏è R√©ordonner (T‚Ä¶ croissant)</button>
                </div>
                <div style="overflow:auto; max-height: 60vh;">
                    <table>
                        <thead>
                            <tr>
                                <th style="width:60px;">Done</th>
                                <th style="width:110px;">ID</th>
                                <th>Title</th>
                                <th>Description</th>
                                <th style="width:120px;">Priority</th>
                                <th>Dependencies</th>
                                <th>Tags</th>
                                <th style="width:120px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tbody"></tbody>
                    </table>
                </div>
            </section>

            <!-- PANNEAU LAT√âRAL: R√âCENTS + CHAT -->
            <aside class="card">
                <h2>Chat IA</h2>
                <div class="group" style="margin-bottom:8px;">
                    <input type="password" id="apiKey" placeholder="OpenAI API Key" style="min-width:220px;" />
                    <select id="model">
                        <option value="gpt-4o-mini" selected>gpt-4o-mini</option>
                        <option value="gpt-4o">gpt-4o</option>
                    </select>
                </div>
                <div class="group" style="display:block; width:100%;">
                    <label for="systemPrompt" class="muted">Prompt syst√®me (impose JSON valide)</label>
                    <textarea id="systemPrompt" rows="5" style="width:100%;">Tu es un assistant qui g√®re un fichier tasks.json.
R√©ponds UNIQUEMENT par du JSON strict valide.
Sch√©ma attendu (v1): {"tasks":[{"id":"T001","title":"...","description":"...","priority":"high|medium|low","done":false,"dependencies":[],"tags":[]}]}.
- N'ajoute pas de texte hors JSON.
- Si le JSON actuel est fourni, retourne une version mise √† jour en respectant le sch√©ma.
- Conserve les IDs existants, ajoute-en de nouveaux si n√©cessaire (format T###).</textarea>
                </div>
                <div id="chatBox" class="card" style="margin:8px 0 8px; padding:10px;"></div>
                <textarea id="userMsg" rows="4" placeholder="Ex: D√©compose T002 en 3 sous-t√¢ches d√©pendantes‚Ä¶"
                    style="width:100%;"></textarea>
                <div class="row-actions" style="margin-top:8px;">
                    <button id="btnSend">Envoyer √† l‚ÄôIA</button>
                    <button id="btnInject">‚úÖ Inclure JSON actuel</button>
                </div>
                <p class="muted">‚ö†Ô∏è L'appel direct au navigateur expose votre cl√© API au code client. Pour une prod
                    s√©curis√©e, passez par un proxy serveur ou OpenRouter avec cl√©s c√¥t√© serveur.</p>
            </aside>
        </div>
    </div>

    <script src="dist/renderer.js"></script>
</body>

</html>
